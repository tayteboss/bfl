{{ 'drop-off.css' | asset_url | stylesheet_tag }}
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
  crossorigin=""
>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">

<div class="drop-off">
  <div class="layout-wrapper">
    {% render 'drop-off-map' %}
    <script id="dropOffLocations" type="application/json">
      [
        {% for block in section.blocks %}
        {
          "id": {{ block.settings.id | json }},
          "name": {{ block.settings.name | json }},
          "address": {{ block.settings.address | json }},
          "lat": {{ block.settings.lat | json }},
          "lng": {{ block.settings.lng | json }},
          "phone": {{ block.settings.phone | json }},
          "website": {{ block.settings.website | json }},
          "googleMapsUrl": {{ block.settings.google_maps_url | json }},
          "thumbnail": {% if block.settings.thumbnail %}{{ block.settings.thumbnail | image_url: width: 800 | json }}{% else %}null{% endif %}
        }{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ]
    </script>
  </div>
</div>

<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
  defer
></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" defer></script>
<script defer src="{{ 'drop-off-map.js' | asset_url }}"></script>

{% schema %}
{
  "name": "Drop-off",
  "settings": [],
  "blocks": [
    {
      "type": "location",
      "name": "Location",
      "settings": [
        { "type": "text", "id": "id", "label": "ID" },
        { "type": "text", "id": "name", "label": "Name" },
        { "type": "text", "id": "address", "label": "Address" },
        { "type": "text", "id": "lat", "label": "Latitude" },
        { "type": "text", "id": "lng", "label": "Longitude" },
        { "type": "text", "id": "phone", "label": "Phone number" },
        { "type": "url", "id": "website", "label": "Website" },
        { "type": "url", "id": "google_maps_url", "label": "Google Maps URL" },
        { "type": "image_picker", "id": "thumbnail", "label": "Thumbnail image" }
      ]
    }
  ],
  "max_blocks": 50,
  "presets": [
    {
      "name": "Drop-off",
      "category": "Drop Off Page"
    }
  ]
}
{% endschema %}
