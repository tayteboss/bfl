{% comment %}
  Renders a product card

  Usage:
  {% render 'product-card', product: product %}
{% endcomment %}

{{ 'product-card.css' | asset_url | stylesheet_tag }}

<a
  class="product-card"
  href="{{ product.url }}"
  target="_self"
  aria-label="{{ product.title }} by {{ product.vendor }} - {{ product.price | money }}"
  role="article"
  data-product-tags="{{ product.tags | join: ',' }}"
  data-product-vendor="{{ product.vendor }}"
  data-product-collections="{% for c in product.collections %}{{ c.title }}{% unless forloop.last %},{% endunless %}{% endfor %}"
>
  {% assign product_image = product.media | first %}
  {% assign bg_image = product.media[1] %}

  <div
    class="product-card__image-wrapper"
  >
    {% if product.metafields.custom.product_badge %}
      <div class="product-badge" role="text" aria-label="Product badge: {{ product.metafields.custom.product_badge }}">
        {{ product.metafields.custom.product_badge | metafield_tag }}
      </div>
    {% endif %}

    <div class="product-card__image-ratio">
      {% if bg_image %}
        <div
          class="product-card__bg-image-inner"
          role="img"
          aria-label="Background image for {{ product.title }}"
        >
          <img
            src="{{ bg_image.src | image_url }}"
            alt=""
            class="product-card__bg-image"
            width="auto"
            height="auto"
          >
        </div>
      {% endif %}
      {% if product_image %}
        <div
          class="product-card__product-image"
          role="img"
          aria-label="Primary image of {{ product.title }}"
        >
          <img
            src="{{ product_image.src | image_url }}"
            alt=""
            class="product-card__image product-card__image--primary"
            width="auto"
            height="auto"
          >
        </div>
      {% endif %}
    </div>
  </div>
  <div class="product-card-content">
    <p class="product-card-content__brand type-h4" aria-label="Brand">
      {{ product.vendor }}
    </p>
    <p class="product-card-content__title type-p">
      {{ product.title }}
    </p>
    <div class="product-card-content__price type-p-small" aria-label="Price">
      <span aria-hidden="true">{{ cart.currency.iso_code }}</span>
      <span>{{ product.price | money }}</span>
    </div>
  </div>
</a>
